# домашняя работа №4

[Architectural decision record](./ADR-001.md)

|Название проблемы|Из-за чего возникла проблема|Как проблема решилась|
|-----------------|----------------------------|---------------------|
|[Problem-010] Долго определяется правильность выполнения задания от кандидата. Это вызывает задержки, которые бесят менеджеров и кандидатов в учителя|Проблема возникла потому-что проверка домашних заданий находится в другом сервисе|Проблему решили стримингом заданий напрямую из сервиса создания контента|
|[Problem-020] Кандидаты в учителя читерят систему в месте, где простое задание должно усложниться, но этого ещё не произошло. Для этого они собираются в группы, где делятся лёгкими заданиями между собой, и, пока задание обновляется, пачкой выполняют лёгкие версии.  Главная проблема тут в том, что нужно как можно быстрее менять задание для кандидатов в учителя, после того, как менеджер поправит задание|||
|[Problem-030] Логика начисления бонусов некорректна из-за ошибки с рейтингом задания. Во время начисления бонусов во время изменения рейтинга, происходит задержка, которая не удовлетворяет бизнес (нужно моментально)|Проблема появилась, потому что рейтинг задания считался отдельно от расчета бонусов |Вычисляем рейтинг вместе с расчетом бонусов|
|[Problem-040] Медленно начисляются бонусы менеджерам, потому что много кандидатов в учителя. Иногда вся система падает и не восстанавливается|Проблема связана с синхронной связью начисления бонусов|Решили проблему заменой связи на асинхронную|
|[Problem-050] В UI может отобразиться ошибка каких-то запросов после успешного выполнения задания. Разработчики объясняют это поведение вызовом сервиса оплаты и создания заданий|Проблема связана с ретраями при синхронной связи|Заменили на асинхронную связь с outbox|
|[Problem-060] Нужно сократить расходы на скейлинг сервиса заданий. Сейчас дорого|||
|[Problem-070] Менеджерам иногда начисляются бонусы дважды. Это связано с тем, что, когда кандидаты в учителя отправляют то же самое задание повторно, система тупит [Problem-050]. Разработчики объясняют тем, что управление заданиями падает, а бонусами — нет. Из-за этого бонусы попадают в два одинаковых запроса|||
|[Problem-080] Упавший сервис создания заданий или бонусов кладёт всю систему, и кандидаты в учителя не могут выполнять задания|Проблема связана с наличием синхронных связей между сервисами|Заменили связи на асинхронные|
|[Problem-090] Фичи выходят слишком медленно. Это связано с тем, что для выполнения любой фичи нужно изучить всю систему и проверить, что ничего не упало. Короче, разработчики сами не понимают, как работает система вне отдельного сервиса|Проблема большой связности между сервисами|Решили изменением связей чтобы снизить связность|
|[Problem-100] Данные теряются вокруг логики выполнения заданий кандидатами в учителя|||